# Milestone v2.0: Features + polish

**Status:** ✅ SHIPPED 2026-01-26
**Phases:** 5–15
**Total Plans:** 46

## Overview

v2.0 förbättrar totalsumma-confidence, lägger till manuell validering med inlärning, integrerar AI som fallback, dual extraction (pdfplumber + OCR), UI-polish, About + ikoner, samt extraction fallback-optimering och quality hardening. Målet är färre REVIEW-status och robustare extraktion via pdfplumber → OCR → AI text → AI vision.

## Phases

### Phase 5: Improved Confidence Scoring
**Goal:** Enhanced multi-factor confidence scoring for total amount to reduce REVIEW status.
**Depends on:** Phase 3 (v1.0 complete)
**Plans:** 3 — 05-01 (Enhanced Multi-Factor Scoring), 05-02 (Confidence Calibration), 05-03 (Calibration Validation CLI). All complete.

### Phase 6: Manual Validation UI
**Goal:** Clickable PDF viewer with candidate selection for user corrections.
**Depends on:** Phase 5
**Plans:** 4 — 06-01–06-04. All complete.

### Phase 7: Learning System
**Goal:** SQLite database and pattern matching to learn from user corrections.
**Depends on:** Phase 6
**Plans:** 6 — 07-01–07-06. All complete.

### Phase 8: AI Integration
**Goal:** AI fallback when confidence < 0.95 to improve extraction for edge cases.
**Depends on:** Phase 5
**Plans:** 3 — 08-01–08-03. All complete.

### Phase 9: AI Data Analysis (Optional)
**Goal:** Natural language queries and data analysis over processed invoices.
**Depends on:** Phase 8
**Plans:** 3 — 09-01–09-03. All complete.

### Phase 10: AI Fallback Fixes and Verification
**Goal:** Document AI fallback fixes and verify behaviour.
**Depends on:** Phase 9
**Plans:** 2 — 10-01 (Document), 10-02 (Verification). All complete.

### Phase 11: Pdfplumber och OCR: kör båda, jämför, använd bästa
**Goal:** Dual extraction; compare results; use best per invoice.
**Depends on:** Phase 10
**Plans:** 3 — 11-01 (OCR wiring), 11-02 (Dual-run compare), 11-03 (Use best downstream). All complete.

### Phase 12: UI Polish (PySide6)
**Goal:** Theme, layout, engine states for desktop-GUI.
**Depends on:** Phase 6, Phase 11
**Plans:** 6 — 12-01–12-06. 12-01–12-05 complete; 12-06 part of phase scope.

### Phase 13: About page + app icons (branding & help)
**Goal:** Om-dialog, Hjälp-meny, fönsterikoner.
**Depends on:** Phase 12
**Plans:** 3 — 13-01–13-03. All complete.

### Phase 14: Extraction fallback optimization (pdfplumber → OCR → AI → vision)
**Goal:** Per-page fallback, text quality scoring, DPI retry, AI vision.
**Depends on:** Phase 13
**Plans:** 6 — 14-01–14-06. All complete.

### Phase 15: Extraction quality hardening
**Goal:** OCR confidence + routing + parser robustness (D1–D8).
**Depends on:** Phase 14
**Plans:** 8 — 15-01–15-08. All complete (15-07 delvis: footer/header-refaktor uppskjuten).

---

## Milestone Summary

**Key Decisions:**
- AI fallback only when confidence < 0.95 (avoid over-reliance).
- Learning system: SQLite, supplier-specific patterns, local storage.
- Manual validation: clickable PDF, candidate selection, one-click workflow.
- Confidence calibration mapped to actual accuracy from start.
- Dual extraction: run both pdfplumber and OCR, compare, use best.
- Fallback chain: pdfplumber → OCR → AI text → AI vision with text quality and R4 thresholds.

**Issues Resolved:**
- AI fallback documentation and verification (Phase 10).
- OCR path wiring and coordinate scaling (Phase 11).
- Extraction orchestration and run_summary (Phase 14, 15).
- Line parser HARD/SOFT footer, O(n²) removal (Phase 15).

**Issues Deferred:**
- Phase 15-07: full footer refactor (candidate → scoring → learning → calibration → routing) and header negative labels/bbox for split tokens — deferred to later iteration.

**Technical Debt:**
- 15-07: footer_extractor refactor and extended header negative-filtering remain as future work.

---

_For current project status, see .planning/PROJECT.md and /gsd:new-milestone for next roadmap._
