---
phase: 12-ui-polish-pyside6
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/ui/theme/tokens.py, src/ui/theme/app_style.qss, src/ui/theme/apply_theme.py, src/ui/app.py]
autonomous: true

must_haves:
  truths:
    - "Design tokens (colors, spacing, typography, radius) live in src/ui/theme/tokens.py"
    - "Global QSS is loaded from src/ui/theme/app_style.qss and applied to the app"
    - "Theme is applied in src/ui/app.py right after QApplication()"
  artifacts:
    - path: "src/ui/theme/tokens.py"
      provides: "Design tokens for colors, spacing, typography sizes, radius"
    - path: "src/ui/theme/app_style.qss"
      provides: "Modern QSS for buttons, inputs, lists/tables, dialogs, toolbar, statusbar"
    - path: "src/ui/theme/apply_theme.py"
      provides: "apply_theme(app) loads QSS and sets app font/palette"
  key_links:
    - from: "src/ui/app.py"
      to: "src/ui/theme/apply_theme.py"
      via: "Calls apply_theme(app) after QApplication()"
---

<objective>
Create a global theme system under src/ui/theme/ and apply it in app.py. No new dependencies; pure PySide6 + QSS. See 12-DISCUSS.md §1.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/12-ui-polish-pyside6/12-CONTEXT.md
@.planning/phases/12-ui-polish-pyside6/12-DISCUSS.md
@src/ui/app.py
</context>

<tasks>

<task type="auto">
  <name>Create src/ui/theme/ and tokens.py</name>
  <files>src/ui/theme/__init__.py, src/ui/theme/tokens.py</files>
  <action>
Create package src/ui/theme/ and tokens.py with design tokens (Python constants or a simple namespace).

**tokens.py should define:**
- Colors: e.g. primary, secondary, background, surface, text, text_muted, border, success, warning, error.
- Spacing scale: e.g. xs=2, sm=4, md=8, lg=16, xl=24 (pixels or pt).
- Typography: font_family (system default or one cross‑platform, e.g. "Segoe UI"/"SF Pro"/fallback), font_size_base, font_size_small, font_size_large.
- Radius: radius_sm, radius_md, radius_lg for rounded corners.

Use simple names that can be referenced from QSS via string substitution if you generate QSS from Python, or keep QSS self‑contained and use tokens only for any programmatic styling (e.g. setFont). Prefer a minimal set so app_style.qss can be mostly standalone.
  </action>
  <verify>python -c "from src.ui.theme.tokens import *; print('tokens load ok')"</verify>
</task>

<task type="auto">
  <name>Create app_style.qss</name>
  <files>src/ui/theme/app_style.qss</files>
  <action>
Create app_style.qss with modern QSS for:
- QPushButton (normal, hover, pressed, disabled)
- QLineEdit, QComboBox, QSpinBox (inputs)
- QListWidget, QTableWidget (lists/tables)
- QDialog, QGroupBox
- QToolBar
- QStatusBar

Use a cohesive palette (e.g. light grey background, dark text, accent for primary actions). Reference 12-DISCUSS: "modern, consistent, professional". Keep it readable and minimal — no new dependencies.
  </action>
  <verify>File exists and is valid QSS syntax (no Python parse); manual check in UI after apply_theme is wired.</verify>
</task>

<task type="auto">
  <name>Create apply_theme.py</name>
  <files>src/ui/theme/apply_theme.py</files>
  <action>
Implement apply_theme(app: QApplication) that:
1. Resolves the path to app_style.qss (e.g. next to apply_theme.py or via package resources).
2. Loads the QSS file and calls app.setStyleSheet(qss_string).
3. Optionally sets app font from tokens (e.g. QFont(tokens.font_family, tokens.font_size_base)).
4. Does not require new dependencies; use pathlib and open().
  </action>
  <verify>python -c "from PySide6.QtWidgets import QApplication; from src.ui.theme.apply_theme import apply_theme; import sys; app=QApplication(sys.argv); apply_theme(app); print('apply_theme ok')"</verify>
</task>

<task type="auto">
  <name>Apply theme in app.py</name>
  <files>src/ui/app.py</files>
  <action>
In main(), after QApplication(sys.argv), call apply_theme(app) before creating MainWindow. Import apply_theme from src.ui.theme.apply_theme (or .theme).
  </action>
  <verify>python -c "from src.ui.app import main; print('app imports and apply_theme is used')" then run run_gui.py briefly and confirm window uses the stylesheet.</verify>
</task>

</tasks>

<success_criteria>
- UI theme applied globally and consistent (tokens + QSS + apply in app.py). All changes under src/ui/.
</success_criteria>
